{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Mario%20GGS/fp-ecommerce/src/app/productname/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useSearchParams } from \"next/navigation\";\nimport { useEffect, useState } from \"react\";\nimport { useCart } from \"../index/carrito\";\nimport { supabase } from \"../lib/supabaseClient\";\n\n// Definir interfaces para los datos\ninterface PrecioProducto {\n  id_precio: number;\n  id_producto: number;\n  id_establecimiento: number;\n  precio_producto: number;\n  nombre_establecimiento: string;\n}\n\n// Interfaz para las props del componente ProductsComponent\ninterface ProductsComponentProps {\n  precios: PrecioProducto[];\n  nombreProducto: string;\n}\n\n// Componente para mostrar los precios de los productos\nconst ProductsComponent = ({\n  precios,\n  nombreProducto,\n}: ProductsComponentProps) => {\n  const [cantidades, setCantidades] = useState<{ [key: number]: number }>({});\n  const { addItem, openCart, isOpen } = useCart();\n  const [shouldOpenCart, setShouldOpenCart] = useState(false);\n\n  // Inicializar cantidades al cargar el componente\n  useEffect(() => {\n    const cantidadesIniciales: { [key: number]: number } = {};\n    precios.forEach((precio) => {\n      cantidadesIniciales[precio.id_precio] = 1;\n    });\n    setCantidades(cantidadesIniciales);\n  }, [precios]);\n\n  // Usa un efecto para abrir el carrito solo una vez después de agregar el primer producto\n  useEffect(() => {\n    if (shouldOpenCart) {\n      openCart();\n      setShouldOpenCart(false);\n    }\n  }, [shouldOpenCart, openCart]);\n\n  // Función para incrementar la cantidad\n  const incrementarCantidad = (precioId: number) => {\n    setCantidades((prev) => ({\n      ...prev,\n      [precioId]: (prev[precioId] || 1) + 1,\n    }));\n  };\n\n  // Función para decrementar la cantidad\n  const decrementarCantidad = (precioId: number) => {\n    setCantidades((prev) => ({\n      ...prev,\n      [precioId]: Math.max(1, (prev[precioId] || 1) - 1),\n    }));\n  };\n\n  // Función para agregar a la lista\n  const agregarALista = (\n    productoId: number,\n    establecimiento: string,\n    precio: number,\n    cantidad: number\n  ) => {\n    // Agregar el producto al carrito sin abrir el carrito\n    addItem(\n      {\n        id: productoId,\n        nombre: nombreProducto,\n        precio: precio,\n        establecimiento: establecimiento,\n      },\n      cantidad\n    );\n\n    // Si el carrito está cerrado, configurar para abrirlo una sola vez\n    if (!isOpen) {\n      setShouldOpenCart(true);\n    }\n  };\n\n  return (\n    <div className=\"w-full max-w-7xl p-4\">\n      <h2 className=\"text-xl md:text-2xl font-bold mb-4 md:mb-6 text-center md:text-left\">\n        Precios en diferentes establecimientos\n      </h2>\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6\">\n        {precios.map((precio) => {\n          const cantidad = cantidades[precio.id_precio] || 1;\n\n          return (\n            <div\n              key={precio.id_precio}\n              className=\"border rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow\"\n            >\n              {/* Contenedor de imagen responsive */}\n              <div className=\"h-32 md:h-40 bg-gray-100 rounded-md mb-3 md:mb-4 flex items-center justify-center overflow-hidden\">\n                <span className=\"text-gray-500 text-center px-3 text-sm md:text-base\">\n                  {nombreProducto}\n                </span>\n              </div>\n\n              <h3 className=\"font-semibold text-base md:text-lg mb-2 line-clamp-1\">\n                {precio.nombre_establecimiento}\n              </h3>\n              <div className=\"mb-3 md:mb-4\">\n                <p className=\"text-xl md:text-2xl font-bold text-red-600\">\n                  ${precio.precio_producto.toFixed(2)}\n                </p>\n              </div>\n              <div className=\"flex items-center mb-3 md:mb-4\">\n                <span className=\"mr-2 text-sm md:text-base\">Cantidad:</span>\n                <div className=\"flex border rounded\">\n                  <button\n                    onClick={() => decrementarCantidad(precio.id_precio)}\n                    className=\"px-2 md:px-3 py-1 bg-gray-100 hover:bg-gray-200 text-sm md:text-base\"\n                  >\n                    -\n                  </button>\n                  <span className=\"px-2 md:px-3 py-1 min-w-[32px] md:min-w-[40px] text-center text-sm md:text-base\">\n                    {cantidad}\n                  </span>\n                  <button\n                    onClick={() => incrementarCantidad(precio.id_precio)}\n                    className=\"px-2 md:px-3 py-1 bg-gray-100 hover:bg-gray-200 text-sm md:text-base\"\n                  >\n                    +\n                  </button>\n                </div>\n              </div>\n              <button\n                onClick={() =>\n                  agregarALista(\n                    precio.id_producto,\n                    precio.nombre_establecimiento,\n                    precio.precio_producto,\n                    cantidad\n                  )\n                }\n                className=\"w-full bg-red-600 text-white py-2 rounded hover:bg-red-700 transition-colors text-sm md:text-base\"\n              >\n                Agregar a la lista\n              </button>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default function Page() {\n  const searchParams = useSearchParams();\n  const nombreProducto = searchParams.get(\"nombre\") || \"Producto\";\n\n  const [precios, setPrecios] = useState<PrecioProducto[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    async function fetchPreciosProducto() {\n      try {\n        // Primero obtener el ID del producto por su nombre\n        const { data: productoData, error: productoError } = await supabase\n          .from(\"productos\")\n          .select(\"id_producto\")\n          .eq(\"nombre_producto\", nombreProducto)\n          .single();\n\n        if (productoError) {\n          throw productoError;\n        }\n\n        if (!productoData) {\n          setError(\"Producto no encontrado\");\n          return;\n        }\n\n        const idProducto = productoData.id_producto;\n\n        // Luego obtener los precios para ese producto\n        const { data: preciosData, error: preciosError } = await supabase\n          .from(\"precios\")\n          .select(\n            `\n            id_precio,\n            id_producto,\n            id_establecimiento,\n            precio_producto,\n            establecimientos(nombre_establecimiento)\n          `\n          )\n          .eq(\"id_producto\", idProducto);\n\n        if (preciosError) {\n          throw preciosError;\n        }\n\n        // Formatear los datos para tener una estructura más plana\n        const preciosFormateados = preciosData.map((precio) => ({\n          id_precio: precio.id_precio,\n          id_producto: precio.id_producto,\n          id_establecimiento: precio.id_establecimiento,\n          precio_producto: precio.precio_producto,\n          nombre_establecimiento:\n            precio.establecimientos.nombre_establecimiento,\n        }));\n\n        setPrecios(preciosFormateados);\n      } catch (error) {\n        console.error(\"Error al cargar precios:\", error);\n        setError(\"Error al cargar información de precios\");\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    fetchPreciosProducto();\n  }, [nombreProducto]);\n\n  return (\n    <div className=\"container mx-auto px-4 py-6 md:py-10\">\n      <div className=\"flex justify-center items-center mb-6 md:mb-10\">\n        <h1 className=\"text-3xl md:text-4xl lg:text-6xl font-bold text-center break-words max-w-full\">\n          {nombreProducto}\n        </h1>\n      </div>\n\n      {loading ? (\n        <div className=\"flex justify-center items-center py-12\">\n          <div className=\"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-red-600\"></div>\n          <span className=\"ml-3 text-lg\">\n            Cargando información del producto...\n          </span>\n        </div>\n      ) : error ? (\n        <div className=\"flex justify-center items-center py-10 px-4\">\n          <div className=\"bg-red-100 text-red-700 p-4 rounded-md max-w-md text-center\">\n            <p className=\"font-medium\">{error}</p>\n            <p className=\"mt-2 text-sm\">\n              Intenta con otro producto o vuelve más tarde.\n            </p>\n          </div>\n        </div>\n      ) : (\n        <div className=\"flex justify-center items-start\">\n          <ProductsComponent\n            precios={precios}\n            nombreProducto={nombreProducto}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 357, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}